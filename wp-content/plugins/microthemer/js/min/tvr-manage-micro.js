jQuery("html").addClass("js"),jQuery(document).ready(function(e){var a={init:function(){TvrCombo.packTypes=[js_i18n_manage.theme_skin,js_i18n_manage.plugin_skin,js_i18n_manage.theme_scaffold,js_i18n_manage.plugin_scaffold],window.parent.TvrSharedVars&&window.parent.TvrSharedVars.isDomEl(e("#update-packs-list"))&&window.parent.TvrSharedVars.update_packs_obj(e("#update-packs-list").attr("rel")),e("input.combobox").live("focus",function(){var a=e(this);a.autocomplete({source:TvrCombo[a.attr("rel")],delay:0,minLength:0,appendTo:a.parent(".input-wrap"),open:function(e,n){a.next(".combo-arrow").addClass("on")},select:function(e,n){if(a.val(n.item.value),a.parent(".input-wrap").addClass("manual-val").find(".comp-style").addClass("hidden").end().find(".combo-arrow").removeClass("on"),"css_unit_set"==a.attr("id")){var t=a.val();a.closest("ul").find("input.custom_css_unit").val(t)}},search:function(e,n){a.addClass("adjusted-corner-radius")},close:function(e,n){a.removeClass("adjusted-corner-radius").next(".combo-arrow").removeClass("on")}})}),e("span.combo-arrow").live("mousedown",function(){e(this).siblings(".ui-menu").is(":visible")&&(a.wasOpen=!0)}),e("span.combo-arrow").live("click",function(){var n=e(this),t=n.prev();return a.wasOpen?(n.removeClass("on"),void(a.wasOpen=!1)):(n.addClass("on"),void t.focus().autocomplete("search",""))});var n=e("#tvr");n.click(function(n){var t=e(n.target);try{if(o=t.attr("class"),!o)var o="tvr-undefined"}catch(i){}if(o.indexOf("pack-action")>=0||o.indexOf("pack-icon")>=0||o.indexOf("action-text")>=0){var r=t.closest(".pack-action");a.pack_button_action(r)}else o.indexOf("delete-pack-multi")>=0?a.delete_pack(t,"multi"):o.indexOf("download-pack-multi")>=0?a.download_pack(t,"multi"):o.indexOf("combobox")>=0?a.combobox_clicked(t):o.indexOf("delete-file")>=0?a.delete_file(t,n):o.indexOf("show-dialog")>=0?a.show_dialog(t):o.indexOf("show-parent-dialog")>=0?window.parent.TvrSharedVars.show_dialog(t):o.indexOf("close-dialog")>=0||o.indexOf("tvr-dialog")>=0?a.close_dialog(t):o.indexOf("color-img")>=0?a.color_img(t):o.indexOf("fake-checkbox")>=0||o.indexOf("fake-radio")>=0?a.toggle_radio_checkbox(t):o.indexOf("upload-pack")>=0?e("#upload_pack_input").val()||(alert(js_i18n_manage.select_zip),n.preventDefault()):o.indexOf("dialog-tab")>=0&&o.indexOf("dialog-tabs")<0?a.dialog_tab_pressed(t):o.indexOf("reveal-hidden-form-opts")>=0?a.reveal_form_opts(t):o.indexOf("save-preferences")>=0&&a.save_preferences(t)})},escape_backslashes:function(e,a){return a?e.replace(/%5C/g,"%26%2392%3B"):e.replace(/\\/g,"&#92;")},save_preferences:function(n){var t="Preferences save",o=e("#ui-url").attr("rel"),i=js_i18n_manage.saving_preferences,r="POST",l=a.escape_backslashes(e("#tvr-preferences").serialize(),!0);a.general_ajax_submission(t,o,i,r,l,n)},general_ajax_submission:function(n,t,o,i,r,l){l.after(e("#loading-gif-template").clone().removeAttr("id").attr("title",js_i18n_manage.saving_preferences)),e.ajax({type:i,url:t,data:r,timeout:2e4,error:function(n,t){e("img.ajax-loader").remove(),alert(a.handle_ajax_error(n,t))},success:function(){window.location=t}})},reveal_form_opts:function(e){var a=e.attr("rel");e.closest("li").siblings(".hidden."+a).addClass("show")},dialog_tab_pressed:function(e){var n=e.closest(".dialog-main"),t=".dialog-tab-field",o=n.find(".dialog-tabs"),i=e.attr("rel"),r=".dialog-tab",l=".dummy-for-now";a.update_tab(n,t,o,i,r,l)},update_tab:function(e,a,n,t,o,i,r){n.find(o).removeClass("active").end().find(o+"-"+t).addClass("active").end().find(i).val(t),r||e.find(a+".show").removeClass("show").end().find(a+"-"+t).addClass("show")},color_img:function(a){e.colorbox({maxWidth:"97%",maxHeight:"90%",href:a.attr("src"),open:!0})},combobox_clicked:function(e){e.autocomplete("search","").next(".combo-arrow").addClass("on")},pack_button_action:function(n){var t=n.attr("rel");if("info"==t||"attachments"==t||"instructions"==t){e("#main-theme-actions").find(".pack-action").removeClass("on"),e("#single-content-areas").find(".manage-content-wrap").removeClass("show");e("#main-theme-actions").find("li.pack-action-"+t).addClass("on"),e("#edit-"+t).addClass("show")}else"download"==t?a.download_pack(n,"single"):"delete"==t&&a.delete_pack(n,"single")},download_pack:function(n,t){var o=e("#zip-folder").attr("rel"),i=n.attr("data-dir-name"),r=o+i+".zip";"single"==t?n.after(e("#loading-gif-template-wbg").clone().attr("id","loading-gif-active")):n.before(e("#loading-gif-template-wbg").clone().attr("id","loading-gif-active"));var l=e("#ajaxUrl").attr("rel")+"&action=tvr_download_pack&dir_name="+i;e.ajax({type:"GET",url:l,async:!0,timeout:2e4,error:function(n,t){var o=e("#log-item-template").clone().removeAttr("id");o.find(".short").text("Download failed").end().find(".long").html("<p>"+js_i18n_manage.download_failed+"</p><p>"+a.handle_ajax_error(n,t)+"</p>"),e("#full-logs").html('<ul class="logs"></ul>').find("ul").append(o).focus()},success:function(a){var n=e(a).find("#microthemer-notice"),t=e(a).find("#download-status").attr("rel");"1"===t?location.href=r:e("#full-logs").html(n.html()).focus()},complete:function(){e("#loading-gif-active").remove()}})},delete_pack:function(n,t){var o=confirm(js_i18n_manage.delete_pack_confirm);if(!o)return!1;"single"==t?n.after(e("#loading-gif-template-wbg").clone().attr("id","loading-gif-active")):n.before(e("#loading-gif-template-wbg").clone().attr("id","loading-gif-active"));var i=n.attr("data-dir-name"),r=e("#ajaxUrl").attr("rel")+"&action=tvr_delete_micro_theme&dir_name="+i,l=e("#delete-ok").attr("rel");e.ajax({type:"GET",url:r,async:!0,timeout:2e4,error:function(n,t){var o=e("#log-item-template").clone().removeAttr("id");o.find(".short").text("Delete failed").end().find(".long").html("<p>"+js_i18n_manage.delete_pack_failed+"</p><p>"+a.handle_ajax_error(n,t)+"</p>"),e("#full-logs").html('<ul class="logs"></ul>').find("ul").append(o).focus(),e("#loading-gif-active").remove()},success:function(a){var o=e(a).find("#microthemer-notice"),r=e(a).find("#delete-status").attr("rel");if("1"===r)if("single"==t)window.location=l;else{e("#loading-gif-active").remove(),n.closest("li").fadeOut("slow");var s=e("li.last-modified");s.attr("rel")==i&&s.remove()}else e("#full-logs").html(o.html()).focus()},complete:function(){}})},handle_ajax_error:function(e,a){return 0==e.status?js_i18n_manage.error_connection:404==e.status?js_i18n_manage.error_404:500==e.status?js_i18n_manage.error_500:"parsererror"==a?js_i18n_manage.error_parser:"timeout"==a?js_i18n_manage.error_timeout:js_i18n_manage.error_unknown+"\n"+e.responseText},export_zip_button:function(a,n){if("warn"==e("span#external-notice").text()){var t=confirm(js_i18n_manage.external_notice);t||n.preventDefault()}},delete_file:function(e,a){var n=confirm(js_i18n_manage.delete_file_confirm);n&&(window.location=e.attr("data-href"))},show_dialog:function(n){a.close_dialog();var t=n.attr("rel");if("not-yet"==t)return!1;var o=n.attr("data-ext"),i=n.attr("data-href")+"?nocache="+(new Date).getTime();if("view-pack-file"==t)if("image"==o)e.colorbox({maxWidth:"97%",maxHeight:"90%",href:i,open:!0});else{var r=["txt","json","css","html"];jQuery.inArray(o,r)<0?alert(js_i18n_manage.view_pack_failed):a.ajax_load_pack_file(n,i)}},close_dialog:function(){e("#tvr").find("div.tvr-dialog").removeClass("show")},toggle_radio_checkbox:function(e){var a=e.prev();if(a.is(":checked")){if(e.hasClass("fake-radio"))return!1;a.prop("checked",!1),e.removeClass("on")}else e.hasClass("fake-radio")&&e.closest(".fake-radio-parent").find('input[type="radio"]').prop("checked",!1).end().find(".fake-radio").removeClass("on"),a.prop("checked",!0),e.addClass("on")},ajax_load_pack_file:function(n,t){n.attr("data-base-name");n.after(e("#loading-gif-template-mgbg").clone().attr("id","loading-gif-active")),e.ajax({type:"GET",url:t,async:!1,dataType:"text",timeout:2e4,error:function(n,o){var i=e("#log-item-template").clone().removeAttr("id");i.find(".short").text(js_i18n_manage.delete_failed).end().find(".long").html("<p>"+js_i18n_manage.unable_load+t+"</p><p>"+a.handle_ajax_error(n,o)+"</p>"),e("#full-logs").html('<ul class="logs"></ul>').find("ul").append(i).focus()},success:function(a){var n="#pack-file-content";e(n).html(a),e.colorbox({width:"80%",height:"80%",html:e(n).clone().attr("id","pack-file-content-active"),onClosed:function(){},open:!0})},complete:function(){e("#loading-gif-active").remove()}})}};a.init();var n={init:function(){var a=e("#tvr-preferences");a.click(function(a){var n=e(a.target);try{if(t=n.attr("class"),!t)var t="tvr-undefined"}catch(o){}})}};n.init();var t={init:function(){var a=e("#tvr-docs");a.click(function(a){var n=e(a.target);try{if(o=n.attr("class"),!o)var o="tvr-undefined"}catch(i){}(o.indexOf("css-group-heading")>=0||o.indexOf("accordion-menu-arrow")>=0||o.indexOf("pg-icon")>=0||o.indexOf("text-for-group")>=0)&&(n=n.closest(".css-group-heading"),t.update_accordion(n,e("#tvr-docs")))})},update_accordion:function(e,a){var n=a.find("li.accordion-item"),t=e.parent();if(t.hasClass("show-content"))var o=!0;return a.find(".accordion-menu-arrow.on").removeClass("on"),n.slideUp(function(){a.find(".show-content").removeClass("show-content")}),o?!1:(t.find(".accordion-menu-arrow").addClass("on"),e.siblings("li.accordion-item").slideDown(function(){t.addClass("show-content")}),!1)}};t.init()});
//# sourceMappingURL=maps/tvr-manage-micro.js.map
